<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis | Mongo Blog</title>
    <meta name="description" content="A VitePress Blog">
    <meta name="generator" content="VitePress v1.0.0-rc.45">
    <link rel="preload stylesheet" href="/assets/style.Ca9TNGG-.css" as="style">
    
    <script type="module" src="/assets/app.CG_k_zgx.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Bu8hRsVA.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.Bx6qu0xe.js">
    <link rel="modulepreload" href="/assets/chunks/theme.CjF6jIsG.js">
    <link rel="modulepreload" href="/assets/note_Redis.md.CaBC19zA.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-09f48466><!--[--><!--]--><!--[--><span tabindex="-1" data-v-448eb6bb></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-448eb6bb> Skip to content </a><!--]--><!----><header class="VPNav" data-v-09f48466 data-v-2960f73c><div class="VPNavBar has-sidebar" data-v-2960f73c data-v-239f150d><div class="wrapper" data-v-239f150d><div class="container" data-v-239f150d><div class="title" data-v-239f150d><div class="VPNavBarTitle has-sidebar" data-v-239f150d data-v-0210455f><a class="title" href="/" data-v-0210455f><!--[--><!--]--><!----><span data-v-0210455f>Mongo Blog</span><!--[--><!--]--></a></div></div><div class="content" data-v-239f150d><div class="content-body" data-v-239f150d><!--[--><!--]--><div class="VPNavBarSearch search" data-v-239f150d><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-239f150d data-v-b470d34a><span id="main-nav-aria-label" class="visually-hidden" data-v-b470d34a>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-b470d34a data-v-d67861b1><!--[--><span data-v-d67861b1>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/note/" tabindex="0" data-v-b470d34a data-v-d67861b1><!--[--><span data-v-d67861b1>笔记</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/project/" tabindex="0" data-v-b470d34a data-v-d67861b1><!--[--><span data-v-d67861b1>项目</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/" tabindex="0" data-v-b470d34a data-v-d67861b1><!--[--><span data-v-d67861b1>面试</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-239f150d data-v-6ec974a7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-6ec974a7 data-v-5812f0ae data-v-e4367a8b><span class="check" data-v-e4367a8b><span class="icon" data-v-e4367a8b><!--[--><span class="vpi-sun sun" data-v-5812f0ae></span><span class="vpi-moon moon" data-v-5812f0ae></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-239f150d data-v-affd6941 data-v-ccefc130><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-ccefc130 data-v-ec01c528><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-239f150d data-v-32102689 data-v-947a1321><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-947a1321><span class="vpi-more-horizontal icon" data-v-947a1321></span></button><div class="menu" data-v-947a1321><div class="VPMenu" data-v-947a1321 data-v-7fe84da0><!----><!--[--><!--[--><!----><div class="group" data-v-32102689><div class="item appearance" data-v-32102689><p class="label" data-v-32102689>Appearance</p><div class="appearance-action" data-v-32102689><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-32102689 data-v-5812f0ae data-v-e4367a8b><span class="check" data-v-e4367a8b><span class="icon" data-v-e4367a8b><!--[--><span class="vpi-sun sun" data-v-5812f0ae></span><span class="vpi-moon moon" data-v-5812f0ae></span><!--]--></span></span></button></div></div></div><div class="group" data-v-32102689><div class="item social-links" data-v-32102689><div class="VPSocialLinks social-links-list" data-v-32102689 data-v-ccefc130><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-ccefc130 data-v-ec01c528><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-239f150d data-v-4fc59892><span class="container" data-v-4fc59892><span class="top" data-v-4fc59892></span><span class="middle" data-v-4fc59892></span><span class="bottom" data-v-4fc59892></span></span></button></div></div></div></div><div class="divider" data-v-239f150d><div class="divider-line" data-v-239f150d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-09f48466 data-v-0161dced><div class="container" data-v-0161dced><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-0161dced><span class="vpi-align-left menu-icon" data-v-0161dced></span><span class="menu-text" data-v-0161dced>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-0161dced data-v-8512aa94><button data-v-8512aa94>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-09f48466 data-v-53766b84><div class="curtain" data-v-53766b84></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-53766b84><span class="visually-hidden" id="sidebar-aria-label" data-v-53766b84> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-53766b84><section class="VPSidebarItem level-0 has-active" data-v-53766b84 data-v-4d7ec7f6><div class="item" role="button" tabindex="0" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><h2 class="text" data-v-4d7ec7f6>笔记</h2><!----></div><div class="items" data-v-4d7ec7f6><!--[--><section class="VPSidebarItem level-1" data-v-4d7ec7f6 data-v-4d7ec7f6><div class="item" role="button" tabindex="0" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><h3 class="text" data-v-4d7ec7f6>SpringCloud</h3><!----></div><div class="items" data-v-4d7ec7f6><!--[--><div class="VPSidebarItem level-2 is-link" data-v-4d7ec7f6 data-v-4d7ec7f6><div class="item" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><a class="VPLink link link" href="/note/SpringCloud/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83.html" data-v-4d7ec7f6><!--[--><p class="text" data-v-4d7ec7f6>注册中心</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-4d7ec7f6 data-v-4d7ec7f6><div class="item" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><a class="VPLink link link" href="/note/Java%E5%9F%BA%E7%A1%80.html" data-v-4d7ec7f6><!--[--><p class="text" data-v-4d7ec7f6>Java基础</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-4d7ec7f6 data-v-4d7ec7f6><div class="item" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><a class="VPLink link link" href="/note/MySQL.html" data-v-4d7ec7f6><!--[--><p class="text" data-v-4d7ec7f6>MySQL</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-4d7ec7f6 data-v-4d7ec7f6><div class="item" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><a class="VPLink link link" href="/note/Redis.html" data-v-4d7ec7f6><!--[--><p class="text" data-v-4d7ec7f6>Redis</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-4d7ec7f6 data-v-4d7ec7f6><div class="item" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><a class="VPLink link link" href="/note/%E4%BA%8B%E5%8A%A1.html" data-v-4d7ec7f6><!--[--><p class="text" data-v-4d7ec7f6>事务</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-4d7ec7f6 data-v-4d7ec7f6><div class="item" data-v-4d7ec7f6><div class="indicator" data-v-4d7ec7f6></div><a class="VPLink link link" href="/note/RabbitMQ.html" data-v-4d7ec7f6><!--[--><p class="text" data-v-4d7ec7f6>RabbitMQ</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-09f48466 data-v-6ddd9cad><div class="VPDoc has-sidebar has-aside" data-v-6ddd9cad data-v-f0e6bb9f><!--[--><!--]--><div class="container" data-v-f0e6bb9f><div class="aside" data-v-f0e6bb9f><div class="aside-curtain" data-v-f0e6bb9f></div><div class="aside-container" data-v-f0e6bb9f><div class="aside-content" data-v-f0e6bb9f><div class="VPDocAside" data-v-f0e6bb9f data-v-15ca7508><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-15ca7508 data-v-18b2990b><div class="content" data-v-18b2990b><div class="outline-marker" data-v-18b2990b></div><div class="outline-title" role="heading" aria-level="2" data-v-18b2990b>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-18b2990b><span class="visually-hidden" id="doc-outline-aria-label" data-v-18b2990b> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-18b2990b data-v-13ca2e78><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-15ca7508></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-f0e6bb9f><div class="content-container" data-v-f0e6bb9f><!--[--><!--]--><main class="main" data-v-f0e6bb9f><div style="position:relative;" class="vp-doc _note_Redis" data-v-f0e6bb9f><div><h1 id="缓存" tabindex="-1">缓存 <a class="header-anchor" href="#缓存" aria-label="Permalink to &quot;缓存&quot;">​</a></h1><h2 id="_1-redis的使用场景" tabindex="-1">1.Redis的使用场景 <a class="header-anchor" href="#_1-redis的使用场景" aria-label="Permalink to &quot;1.Redis的使用场景&quot;">​</a></h2><ul><li>根据简历上的项目进行回答</li><li>缓存（穿透、击穿、雪崩、双写一致、持久化、数据过期、淘汰策略）</li><li>分布式锁（setnx、redisson）</li></ul><h2 id="_2-什么是缓存穿透-怎么解决" tabindex="-1">2.什么是缓存穿透，怎么解决 <a class="header-anchor" href="#_2-什么是缓存穿透-怎么解决" aria-label="Permalink to &quot;2.什么是缓存穿透，怎么解决&quot;">​</a></h2><ul><li>缓存穿透：查询一个不存在的key，MySQL查询不到也不会写入Redis，导致每次请求都调用数据库</li><li>解决方案1：缓存空数据、实现简单，Redis压力大</li><li>解决方案2：布隆过滤器、实现复杂，缓存预热记录布隆过滤器</li></ul><h2 id="_3-什么是缓存击穿-怎么解决" tabindex="-1">3.什么是缓存击穿，怎么解决 <a class="header-anchor" href="#_3-什么是缓存击穿-怎么解决" aria-label="Permalink to &quot;3.什么是缓存击穿，怎么解决&quot;">​</a></h2><ul><li>缓存击穿：给某一个key设置了过期时间，过期期间大量并发请求进入，压垮数据库</li><li>解决方案1：互斥锁、强一致、性能差</li><li>解决方案2：逻辑过期、高可用、不能保证数据绝对一致</li></ul><h2 id="_4-什么是缓存雪崩-怎么解决" tabindex="-1">4.什么是缓存雪崩，怎么解决 <a class="header-anchor" href="#_4-什么是缓存雪崩-怎么解决" aria-label="Permalink to &quot;4.什么是缓存雪崩，怎么解决&quot;">​</a></h2><ul><li>缓存雪崩：同一时间段大量key同时过期或Redis服务器宕机，导致大量请求打到数据库</li><li>解决方案1：随机Ttl值</li><li>解决方案2：Redis集群</li><li>解决方案3：限流降级 nginx、spring-cloud-gateway</li><li>解决方案4：多级缓存 Guava、Caffeine</li></ul><h2 id="_5-redis缓存如何与mysql进行数据同步-双写一致" tabindex="-1">5.Redis缓存如何与MySQL进行数据同步（双写一致） <a class="header-anchor" href="#_5-redis缓存如何与mysql进行数据同步-双写一致" aria-label="Permalink to &quot;5.Redis缓存如何与MySQL进行数据同步（双写一致）&quot;">​</a></h2><ul><li>先介绍业务</li><li>一致性要求高（强一致）</li><li>允许延迟一致</li></ul><ol><li><p>延时双删</p><ol><li>先删除缓存还是先删除数据库</li><li>为什么删除2此缓存</li><li>为什么要延时删除</li></ol></li><li><p>读多写少：读时添加共享锁（readLock），写时添加排他锁（writeLock）</p></li><li><p>异步通知保证最终一致性</p><ol><li>MQ：更新数据后，消息通知缓存删除</li><li>Canal：读取binlog日志更新缓存</li></ol></li></ol><h2 id="_6-redis数据持久化" tabindex="-1">6.Redis数据持久化 <a class="header-anchor" href="#_6-redis数据持久化" aria-label="Permalink to &quot;6.Redis数据持久化&quot;">​</a></h2><ol><li>RDB（数据快照）：把内存中所有数据文件记录到磁盘，Redis启动从磁盘快照恢复数据 <img src="/assets/image_redis.DHUqwjZQ.png" alt="alt text"></li><li>AOF（追加文件）：把Redis的每一个命令记录在AOF文件</li></ol><h2 id="_7-redis数据过期策略" tabindex="-1">7.Redis数据过期策略 <a class="header-anchor" href="#_7-redis数据过期策略" aria-label="Permalink to &quot;7.Redis数据过期策略&quot;">​</a></h2><ol><li>惰性删除：需要key的时候检查是否过期，如果过期则删掉，否则返回key <ul><li>优点：CPU消耗小，只会在使用时过期检查</li><li>缺点：内存不友好，如果一个key一直不使用，那么这个key会一直存在内存中，内存不会释放</li></ul></li><li>定期删除：每隔一段时间，对一些key检查，删除过期的key <ul><li>SLOW：定时任务，每秒10次，每次不超过25ms</li><li>FAST：执行频率不固定，间隔不低于2ms，每次耗时不超过1ms</li></ul></li></ol><p>实际上Redis是惰性删除、定期删除两种结合使用</p><h2 id="_8-redis数据淘汰策略" tabindex="-1">8.Redis数据淘汰策略 <a class="header-anchor" href="#_8-redis数据淘汰策略" aria-label="Permalink to &quot;8.Redis数据淘汰策略&quot;">​</a></h2><p>当Redis内存不够用的时候，继续往Redis添加数据，那么Redis会按照一定的规则将内存中的数据删掉，这种删除的规则被称为内存的淘汰策略 Redis支持8钟不同的策略来选择要删除的key：</p><ul><li>noeviction：不淘汰任何key，内存满时不允许写入任何新数据，默认时这种策略</li><li>volatile-ttl：对设置了ttl的key比较ttl，ttl越小越先淘汰</li><li>allkeys-random：对全体key随机淘汰</li><li>volatile-random：对设置了ttl的key，随机进行淘汰</li><li>allkeys-lru：对全体key，基于lru进行淘汰</li><li>volatile-lru：对设置了ttl的key，基于lru淘汰</li><li>allkeys-lfu：对所有key，基于lfu淘汰</li><li>volatile-lfu：对设置了ttl的key，基于lfu淘汰</li></ul><h2 id="_9-redis集群方案" tabindex="-1">9.Redis集群方案 <a class="header-anchor" href="#_9-redis集群方案" aria-label="Permalink to &quot;9.Redis集群方案&quot;">​</a></h2><ol><li>主从</li><li>哨兵</li><li>分片</li></ol><h2 id="_10-redis是单线程的-为什么会这么快" tabindex="-1">10.Redis是单线程的，为什么会这么快？ <a class="header-anchor" href="#_10-redis是单线程的-为什么会这么快" aria-label="Permalink to &quot;10.Redis是单线程的，为什么会这么快？&quot;">​</a></h2><ul><li>Redis是纯内存操作，执行速度非常快</li><li>采用单线程，避免不必要的线程上下文切换竞争，多线程还需要考虑线程安全问题</li><li>使用I/O多路复用模型，非阻塞I/O <ul><li>Redis是纯内存操作，执行速度非常快，主要性能瓶颈是网络延时而不是执行速度，I/O多路复用模型就是为了实现高效网络请求</li><li>利用单个线程同时监听多个Socket，并在某个Socket可读、可写时得到通知，从而避免无效等待，充分利用CPU资源</li></ul></li></ul></div></div></main><footer class="VPDocFooter" data-v-f0e6bb9f data-v-ba62f331><!--[--><!--]--><!----><nav class="prev-next" data-v-ba62f331><div class="pager" data-v-ba62f331><a class="VPLink link pager-link prev" href="/note/MySQL.html" data-v-ba62f331><!--[--><span class="desc" data-v-ba62f331>Previous page</span><span class="title" data-v-ba62f331>MySQL</span><!--]--></a></div><div class="pager" data-v-ba62f331><a class="VPLink link pager-link next" href="/note/%E4%BA%8B%E5%8A%A1.html" data-v-ba62f331><!--[--><span class="desc" data-v-ba62f331>Next page</span><span class="title" data-v-ba62f331>事务</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"note_java基础.md\":\"DEmcV0Av\",\"index.md\":\"D8zUG4eG\",\"note_springcloud_index.md\":\"Dz9bWn_I\",\"note_rabbitmq.md\":\"CmCXNWhT\",\"note_mysql.md\":\"_p54zaGN\",\"project_第一个项目.md\":\"tWDzD_1d\",\"note_springcloud_注册中心.md\":\"hP2UOHG6\",\"interview_index.md\":\"B173Ct1S\",\"interview_科脉技术.md\":\"CVHY-lH2\",\"note_redis.md\":\"CaBC19zA\",\"note_第一篇笔记.md\":\"B4fllKp6\",\"note_事务.md\":\"CYA29B8z\",\"project_index.md\":\"ERSunx8K\",\"note_index.md\":\"BZzxxxon\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Mongo Blog\",\"description\":\"A VitePress Blog\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"笔记\",\"link\":\"/note/\"},{\"text\":\"项目\",\"link\":\"/project/\"},{\"text\":\"面试\",\"link\":\"/interview/\"}],\"sidebar\":{\"/note/\":[{\"text\":\"笔记\",\"items\":[{\"text\":\"SpringCloud\",\"items\":[{\"text\":\"注册中心\",\"link\":\"/note/SpringCloud/注册中心\"}]},{\"text\":\"Java基础\",\"link\":\"/note/Java基础.md\"},{\"text\":\"MySQL\",\"link\":\"/note/MySQL\"},{\"text\":\"Redis\",\"link\":\"/note/Redis\"},{\"text\":\"事务\",\"link\":\"/note/事务\"},{\"text\":\"RabbitMQ\",\"link\":\"/note/RabbitMQ\"}]}],\"/project/\":[{\"text\":\"项目\",\"items\":[{\"text\":\"第一篇笔记\",\"link\":\"/project/第一个项目\"}]}],\"/interview/\":[{\"text\":\"面试\",\"items\":[{\"text\":\"科脉技术\",\"link\":\"/interview/科脉技术\"},{\"text\":\"面试题\",\"items\":[{\"text\":\"Redis\",\"link\":\"/interview/subject/Redis\"}]}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>